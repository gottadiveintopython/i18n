<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Localizer &#8212; i18n 0.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=bfbd5f32" />
    <script src="_static/documentation_options.js?v=938c9ccc"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Font Finder" href="fontfinder.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="localizer">
<h1>Localizer<a class="headerlink" href="#localizer" title="Link to this heading">¶</a></h1>
<p>This module plays a key role in multilingual localization,
and helps you dynamically switch fonts and texts according to its “current language”.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">¶</a></h2>
<p>There are two types of text sources you can use by default.
One is <code class="docutils literal notranslate"><span class="pre">.mo</span></code> files generated by the <a class="reference external" href="https://www.gnu.org/software/gettext/">gettext</a> toolset.
The other one is a <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Mapping</span></code></a> object like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;greeting&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ja&#39;</span><span class="p">:</span> <span class="s1">&#39;おはよう&#39;</span><span class="p">,</span>
        <span class="s1">&#39;en&#39;</span><span class="p">:</span> <span class="s1">&#39;morning&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;app title&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ja&#39;</span><span class="p">:</span> <span class="s1">&#39;初めてのKivyプログラム&#39;</span><span class="p">,</span>
        <span class="s1">&#39;en&#39;</span><span class="p">:</span> <span class="s1">&#39;My First Kivy App,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The first step is to create a <code class="docutils literal notranslate"><span class="pre">TranslatorFactory</span></code> instance from your source.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy_garden.i18n.localizer</span> <span class="kn">import</span> <span class="n">GettextBasedTranslatorFactory</span><span class="p">,</span> <span class="n">MappingBasedTranslatorFactory</span>

<span class="c1"># gettext</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">GettextBasedTranslatorFactory</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">localedir</span><span class="p">)</span>

<span class="c1"># mapping</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">MappingBasedTranslatorFactory</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
<p>(<code class="docutils literal notranslate"><span class="pre">domain</span></code> and <code class="docutils literal notranslate"><span class="pre">localedir</span></code> are passed to <a class="reference external" href="https://docs.python.org/3/library/gettext.html#gettext.translation" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gettext.translation()</span></code></a>).</p>
<p>Next, create a <code class="docutils literal notranslate"><span class="pre">Localizer</span></code> instance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy_garden.i18n.localizer</span> <span class="kn">import</span> <span class="n">Localizer</span>

<span class="n">loc</span> <span class="o">=</span> <span class="n">Localizer</span><span class="p">(</span><span class="n">translator_factory</span><span class="o">=</span><span class="n">factory</span><span class="p">)</span>
</pre></div>
</div>
<p>And you’re done.
You can now ask it
“What’s the translation of this word?” or “Which font is suitable for your current language?”</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span><span class="o">.</span><span class="n">lang</span> <span class="o">=</span> <span class="s1">&#39;en&#39;</span>  <span class="c1"># set the &quot;current language&quot; to &#39;en&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">font_name</span><span class="p">)</span>  <span class="c1"># =&gt; Roboto</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;greeting&quot;</span><span class="p">))</span>  <span class="c1"># =&gt; morning</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;app title&quot;</span><span class="p">))</span>  <span class="c1"># =&gt; My First Kivy App</span>

<span class="n">loc</span><span class="o">.</span><span class="n">lang</span> <span class="o">=</span> <span class="s1">&#39;ja&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">font_name</span><span class="p">)</span>  <span class="c1"># =&gt; some Japanese font</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;greeting&quot;</span><span class="p">))</span>  <span class="c1"># =&gt; おはよう</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;app title&quot;</span><span class="p">))</span>  <span class="c1"># =&gt; 初めてのKivyプログラム</span>
</pre></div>
</div>
<p>Not only that, since the <code class="docutils literal notranslate"><span class="pre">loc</span></code> is an <a class="reference external" href="https://kivy.org/doc/master/api-kivy.event.html#kivy.event.EventDispatcher" title="(in Kivy v2.3.0.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">kivy.event.EventDispatcher</span></code></a>, and both <code class="docutils literal notranslate"><span class="pre">loc.font_name</span></code> and <code class="docutils literal notranslate"><span class="pre">loc._</span></code> are Kivy properties,
you can take an advantage of its binding feature.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming you assigned the &#39;loc&#39; to &#39;app.loc&#39;</span>
<span class="nt">Label</span><span class="p">:</span>
<span class="w">    </span><span class="nt">font_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app.loc.font_name</span>
<span class="w">    </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app.loc._(&quot;greeting&quot;)</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">loc.lang</span></code> changes, <code class="docutils literal notranslate"><span class="pre">loc._</span></code> and <code class="docutils literal notranslate"><span class="pre">loc.font_name</span></code> will also change,
which causes the <code class="docutils literal notranslate"><span class="pre">app.loc.font_name</span></code> and <code class="docutils literal notranslate"><span class="pre">app.loc._(&quot;greeting&quot;)</span></code> above to be re-evaluated.
Great! You have successfully created a label that dynamically changes its <code class="docutils literal notranslate"><span class="pre">text</span></code> and <code class="docutils literal notranslate"><span class="pre">font_name</span></code> as the <code class="docutils literal notranslate"><span class="pre">loc.lang</span></code> changes.</p>
<p>By the way, <code class="docutils literal notranslate"><span class="pre">app</span></code> is a global variable.
If you don’t hesitate to use that kind, there is a better way.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kivy_garden.i18n.localizer.Localizer.install">
<span class="sig-prename descclassname"><span class="pre">Localizer.</span></span><span class="sig-name descname"><span class="pre">install</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kivy_garden.i18n.localizer.Localizer.install" title="Link to this definition">¶</a></dt>
<dd><p>Makes the localizer accessble from kv without any import-statements.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="n">Localizer</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loc</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">Label</span><span class="p">:</span>
<span class="w">    </span><span class="nt">font_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l.font_name</span>
<span class="w">    </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">l._(&quot;msgid&quot;)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>I18nError</strong> – if the <code class="docutils literal notranslate"><span class="pre">name</span></code> has already been used.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="advanced-usage">
<h2>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Link to this heading">¶</a></h2>
<p>If you want to use other types of text sources, you’ll need to create your own <code class="docutils literal notranslate"><span class="pre">TranslatorFactory</span></code>.
And if you want to customize the way the <code class="docutils literal notranslate"><span class="pre">Localizer</span></code> picks fonts, you’ll need to create your own <code class="docutils literal notranslate"><span class="pre">FontPicker</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kivy_garden.i18n.localizer.Localizer.__init__">
<span class="sig-prename descclassname"><span class="pre">Localizer.</span></span><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lang</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Lang</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'en'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translator_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TranslatorFactory</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_picker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FontPicker</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#kivy_garden.i18n.localizer.Localizer.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TranslatorFactory</span></code> must be a callable that takes a string representing a language, and returns a <code class="docutils literal notranslate"><span class="pre">Translator</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Translator</span></code> must be a callable that takes a <code class="docutils literal notranslate"><span class="pre">msgid</span></code>, and returns a <code class="docutils literal notranslate"><span class="pre">msgstr</span></code>.
If you’ve ever used <a class="reference external" href="https://www.gnu.org/software/gettext/">gettext</a>, you may already know what <code class="docutils literal notranslate"><span class="pre">msgid</span></code> and <code class="docutils literal notranslate"><span class="pre">msgstr</span></code> are.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FontPicker</span></code> must be a callable that takes a string representing a language, and returns a <code class="docutils literal notranslate"><span class="pre">Font</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Font</span></code> must be either a path to a font file or a name registered using <a class="reference external" href="https://kivy.org/doc/master/api-kivy.core.text.html#kivy.core.text.LabelBase.register" title="(in Kivy v2.3.0.dev0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kivy.core.text.LabelBase.register()</span></code></a> e.g. <code class="docutils literal notranslate"><span class="pre">Roboto</span></code>.</p></li>
</ul>
<p>They are defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Msgid</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">str</span>
<span class="n">Msgstr</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">str</span>
<span class="n">Lang</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">str</span>
<span class="n">Translator</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Msgid</span><span class="p">],</span> <span class="n">Msgstr</span><span class="p">]</span>
<span class="n">TranslatorFactory</span> <span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Lang</span><span class="p">],</span> <span class="n">Translator</span><span class="p">]</span>
<span class="n">Font</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="nb">str</span>
<span class="n">FontPicker</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Lang</span><span class="p">],</span> <span class="n">Font</span><span class="p">]</span>
</pre></div>
</div>
<p>You can use any object as long as it satisfies the above constraints.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">i18n</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="fontfinder.html">Font Finder</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Localizer</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="fontfinder.html" title="previous chapter">Font Finder</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Mitō Nattōsai.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/localizer.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>